<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>H·ªá Th·ªëng Marketing Chuy√™n Nghi·ªáp V18.9</title>
    <style>
        :root { --step-bg: #f8f9fa; --accent: #ff4757; --blue: #54a0ff; --green: #1dd1a1; }
        body { font-family: 'Segoe UI', sans-serif; background: #dfe4ea; padding: 20px; }
        
        .station { background: white; border-radius: 20px; padding: 25px; margin-bottom: 25px; box-shadow: 0 8px 16px rgba(0,0,0,0.1); border-top: 8px solid #ccc; }
        .s1 { border-color: #ff9f43; } .s2 { border-color: #5f27cd; } .s3 { border-color: #ff4757; } .s6 { border-color: #2f3542; }

        .btn { padding: 12px 20px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; color: white; transition: 0.3s; margin: 5px; }
        .btn-orange { background: #ee4d2d; } .btn-blue { background: var(--blue); } .btn-green { background: var(--green); }
        
        .market-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }
        .card { background: white; border-radius: 12px; border: 2px solid #eee; cursor: pointer; text-align: center; padding: 10px; }
        .card img { width: 100%; height: 150px; object-fit: cover; border-radius: 8px; }
        .red-bold { color: red; font-size: 24px; font-weight: 900; }

        /* MODAL C√îNG VI·ªÜC B∆Ø·ªöC 4-5 */
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:1000; overflow-y: auto; }
        .modal-content { background: white; width: 95%; max-width: 600px; margin: 20px auto; padding: 25px; border-radius: 20px; }
        .work-step { background: #f1f2f6; padding: 15px; border-radius: 15px; margin-bottom: 15px; text-align: left; border-left: 5px solid var(--blue); }
    </style>
</head>
<body>

<h1 style="text-align:center">üõ°Ô∏è QUY TR√åNH B√ÄY H√ÄNG GITHUB V18.9</h1>

<div class="station s1">
    <h3><span style="background:#333; color:white; padding:5px 10px; border-radius:5px">1</span> N·∫†P KHO & <span style="background:#333; color:white; padding:5px 10px; border-radius:5px">2</span> CH·ªåN NG∆Ø·ªúI</h3>
    <input type="file" id="csv" accept=".csv" style="margin-bottom:10px">
    <div id="luckyName" style="font-size: 25px; font-weight: bold; color: #5f27cd;">---</div>
</div>

<div class="station s2">
    <h3><span style="background:#333; color:white; padding:5px 10px; border-radius:5px">3</span> CH·ªåN QU√Ä THEO CH·ªÆ CU·ªêI</h3>
    <div id="market" class="market-grid"></div>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <h2 id="mTitle" style="color:var(--accent)"></h2>
        
        <div class="work-step">
            <b>üëâ B∆Ø·ªöC 4: X·ª¨ L√ù ·∫¢NH & LINK G·ªêC</b><br>
            1. <button class="btn btn-orange" onclick="copyAndOpenOriginal()">M·ªû SHOPEE G·ªêC (ƒê√É T·ª∞ COPY LINK)</button><br>
            2. Chu·ªôt ph·∫£i v√†o ·∫£nh s·∫£n ph·∫©m to nh·∫•t -> <b>Sao ch√©p ƒë·ªãa ch·ªâ h√¨nh ·∫£nh</b>.<br>
            3. <button class="btn btn-blue" onclick="window.open('https://www.iloveimg.com/vi/chinh-sua-anh/cat-anh', '_blank')">M·ªû WEB CH·ªàNH S·ª¨A H√ÄNG LO·∫†T</button><br>
            4. D√°n ·∫£nh v√†o, ch·ªânh cho vu√¥ng/g·ªçn r·ªìi l·∫•y <b>Link ·∫£nh m·ªõi</b>.
        </div>

        <div class="work-step">
            <b>üëâ B∆Ø·ªöC 5: ƒê∆ØA H√ÄNG V√ÄO KHO (GITHUB)</b><br>
            <label>Link ·∫£nh ƒë√£ ch·ªânh s·ª≠a:</label>
            <input type="text" id="imgFinal" class="big-input" style="width:100%" placeholder="D√°n link ·∫£nh ƒë·∫πp v√†o ƒë√¢y...">
            <label style="margin-top:10px; display:block">Link Shopee r√∫t g·ªçn (Affiliate):</label>
            <input type="text" id="affFinal" class="big-input" style="width:100%" placeholder="D√°n link r√∫t g·ªçn v√†o ƒë√¢y...">
            
            <div style="margin-top:15px; display: flex; justify-content: space-around;">
                <button class="btn btn-green" onclick="askAI('ChatGPT')">ChatGPT</button>
                <button class="btn btn-green" onclick="askAI('Gemini')">Gemini</button>
                <button class="btn btn-green" onclick="askAI('DeepSeek')">DeepSeek</button>
            </div>
        </div>

        <button class="btn" style="background:#636e72" onclick="closeModal()">QUAY L·∫†I</button>
    </div>
</div>

<div class="station s6">
    <h3><span style="background:#333; color:white; padding:5px 10px; border-radius:5px">6</span> XU·∫§T B·∫¢N</h3>
    <button class="btn" style="background: #2d3436; width:100%" onclick="exportJson()">üíæ XU·∫§T FILE FILES.JSON ƒê·ªÇ ƒê∆ØA L√äN GITHUB</button>
</div>

<script>
    const fixedMems = [
        {n:"NGUY·ªÑN KH·∫ÆC NƒÇNG", d:"1944-06-04", g:"Nam", cat:"Ng∆∞·ªùi gi√†"}, 
        {n:"T√î TH·ªä H√Ä", d:"1948-08-29", g:"N·ªØ", cat:"Ng∆∞·ªùi gi√†"},
        {n:"NGUY·ªÑN MINH NAM", d:"1971-03-03", g:"Nam", cat:"Trung ni√™n"},
        {n:"TH√ÇN TH·ªä KIM ANH", d:"1981-09-23", g:"N·ªØ", cat:"Trung ni√™n"}
    ];

    let warehouse = [];
    let lucky = null;
    let selected = null;

    function init() {
        const offset = Math.floor((new Date() - new Date("2026-01-01")) / (1000*60*60*24));
        lucky = fixedMems[offset % fixedMems.length];
        const lastChar = lucky.n.trim().slice(-1);
        document.getElementById('luckyName').innerHTML = `H√¥m nay ƒë·∫øn l∆∞·ª£t: ${lucky.n.slice(0,-1)}<span class="red-bold">${lastChar}</span>`;
    }

    document.getElementById('csv').onchange = async (e) => {
        const text = await e.target.files[0].text();
        const lines = text.split('\n').slice(1);
        warehouse = lines.map(l => {
            const c = l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            if(c.length >= 4) return { id: c[0].trim(), name: c[1].replace(/"/g, ''), price: c[2], img: c[3]?.trim().replace(/"/g, ''), link: c[c.length-1].trim().replace(/"/g, ''), aff: "", imgNew: "" };
        }).filter(x => x);
        renderMarket();
    };

    function renderMarket() {
        const area = document.getElementById('market');
        area.innerHTML = "";
        const char = lucky.n.trim().slice(-1).toUpperCase();

        warehouse.forEach(p => {
            const pChar = p.name.trim().slice(-1).toUpperCase();
            if (pChar !== char) return;
            
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => {
                selected = p;
                document.getElementById('mTitle').innerHTML = p.name;
                document.getElementById('modal').style.display = 'block';
                document.getElementById('imgFinal').value = p.imgNew;
                document.getElementById('affFinal').value = p.aff;
            };
            card.innerHTML = `<img src="${p.img}"><div>${p.name.slice(0,-1)}<span class="red-bold">${p.name.slice(-1)}</span></div>`;
            area.appendChild(card);
        });
    }

    function copyAndOpenOriginal() {
        navigator.clipboard.writeText(selected.link);
        window.open(selected.link, '_blank');
    }

    function askAI(type) {
        selected.aff = document.getElementById('affFinal').value;
        selected.imgNew = document.getElementById('imgFinal').value;
        
        if(!selected.aff || !selected.imgNew) return alert("B√© ph·∫£i d√°n ƒë·ªß Link ·∫£nh m·ªõi v√† Link r√∫t g·ªçn ƒë√£!");

        const ghUrl = `https://namnguyen7133-png.github.io/cua-hang-di-dong/001-kho-hang.html?id=${selected.id}`;
        const prompt = `Vi·∫øt truy·ªán ng·ª• ng√¥n h√†i h∆∞·ªõc v·ªÅ ${lucky.n} (${lucky.g}). Nh√¢n duy√™n ch·ªØ c√°i cu·ªëi "${selected.name.slice(-1)}" d·∫´n ƒë·∫øn m√≥n qu√† "${selected.name}". ƒêƒÉng k√®m ·∫£nh n√†y: ${selected.imgNew}. Link s·ª± t√≠ch GitHub: ${ghUrl}`;
        
        navigator.clipboard.writeText(prompt);
        alert("ƒê√£ copy l·ªùi d·∫´n! H√£y d√°n v√†o " + type);
        window.open(type === 'ChatGPT' ? "https://chatgpt.com" : (type === 'Gemini' ? "https://gemini.google.com" : "https://chat.deepseek.com"), '_blank');
    }

    function closeModal() {
        selected.aff = document.getElementById('affFinal').value;
        selected.imgNew = document.getElementById('imgFinal').value;
        document.getElementById('modal').style.display = 'none';
    }

    function exportJson() {
        const blob = new Blob([JSON.stringify(warehouse, null, 2)], {type: 'application/json'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'files.json';
        a.click();
    }

    init();
</script>
</body>
</html>
