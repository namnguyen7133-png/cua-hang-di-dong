<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>H·ªá Th·ªëng Marketing Gia ƒê√¨nh V18 - FULL T√çNH NƒÇNG</title>
    <style>
        :root { --p: #ee4d2d; --s: #1877F2; --v: #9b59b6; --g: #27ae60; --dark: #2d3436; --x: #000000; --gpt: #10a37f; --shopee: #ff4742; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 15px; margin: 0; }
        .box { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); margin-bottom: 15px; }
        h2 { color: var(--p); border-bottom: 2px solid #eee; padding-bottom: 8px; margin-top: 0; font-size: 16px; text-transform: uppercase; }
        .form-row { display: flex; gap: 8px; flex-wrap: wrap; background: #e3f2fd; padding: 12px; border-radius: 10px; margin-bottom: 15px; align-items: center; }
        input, select { padding: 8px; border: 1px solid #ddd; border-radius: 6px; font-size: 12px; }
        .member-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(115px, 1fr)); gap: 8px; max-height: 250px; overflow-y: auto; padding: 10px; background: #f9f9f9; border-radius: 8px; }
        .m-btn { padding: 8px; border: 1px solid #ddd; border-radius: 6px; cursor: pointer; background: #fff; font-size: 11px; text-align: left; position: relative; }
        .m-btn.active { background: var(--v); color: white; font-weight: bold; }
        .del-btn { position: absolute; top: -5px; right: -5px; background: red; color: white; border: none; border-radius: 50%; width: 18px; height: 18px; cursor: pointer; font-size: 10px; }
        .filter-group { display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 15px; background: #fff9db; padding: 10px; border-radius: 8px; }
        .f-btn { border: none; padding: 8px 12px; border-radius: 20px; cursor: pointer; background: white; border: 1px solid var(--s); font-size: 10px; font-weight: bold; color: var(--s); }
        .f-btn.active { background: var(--s); color: white; }
        .table-container { max-height: 500px; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; background: white; }
        th { background: var(--dark); color: white; padding: 12px; position: sticky; top: 0; }
        td { border-bottom: 1px solid #eee; padding: 10px; text-align: center; }
        .btn-ai { font-size: 9px; margin: 2px; width: 60px; padding: 6px 0; border-radius: 4px; border: none; color: white; cursor: pointer; font-weight: bold; }
        .status-msg { background: #fff3bf; color: #856404; padding: 12px; border-radius: 8px; text-align: center; font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>

<div style="max-width: 1300px; margin: auto;">
    <h1 style="text-align: center; color: var(--p);">üöÄ T·ªîNG KHO MARKETING GIA ƒê√åNH V18</h1>

    <div class="box" style="border: 2px solid var(--shopee);">
        <h2>üîó 1. C·∫§U H√åNH LINK ƒêƒÇNG B√ÄI</h2>
        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <div style="flex: 1; min-width: 250px;">
                <small>Link GitHub (Web di ƒë·ªông):</small><br>
                <input type="text" id="ghLink" style="width: 100%;" value="https://namnguyen7133-png.github.io/cua-hang-di-dong/001-kho-hang.html" onchange="saveAll()">
            </div>
            <div style="flex: 1; min-width: 250px;">
                <small>Link Shopee R√∫t G·ªçn Chung:</small><br>
                <input type="text" id="shopeeLink" style="width: 100%; border-color: var(--shopee);" placeholder="D√°n link shope.ee..." onchange="saveAll()">
            </div>
        </div>
    </div>

    <div class="box">
        <h2>üë• 2. TH√ÄNH VI√äN & NG∆Ø·ªúI NH·∫¨N</h2>
        <div class="form-row">
            <strong>Th√™m ng∆∞·ªùi m·ªõi:</strong>
            <input type="text" id="newName" placeholder="T√™n..." style="width:150px">
            <input type="date" id="newBirth">
            <select id="newGen"><option value="Nam">Nam</option><option value="N·ªØ">N·ªØ</option></select>
            <button onclick="addM()" style="background:var(--g); color:white; border:none; padding:8px 15px; border-radius:6px; cursor:pointer;">+ TH√äM V√ÄO M√ÅY</button>
        </div>
        <div class="member-grid" id="mList"></div>
    </div>

    <div class="box">
        <h2>üì¶ 3. KHO H√ÄNG & CH·ªåN M·ª®C GI√Å</h2>
        <div class="filter-group">
            <strong>T√∫i ti·ªÅn:</strong>
            <button class="f-btn active" onclick="setPriceFilter(0, 999999999, this)">T·∫§T C·∫¢</button>
            <button class="f-btn" onclick="setPriceFilter(10000, 20000, this)">10K - 20K</button>
            <button class="f-btn" onclick="setPriceFilter(20000, 50000, this)">20K - 50K</button>
            <button class="f-btn" onclick="setPriceFilter(50000, 100000, this)">50K - 100K</button>
            <button class="f-btn" onclick="setPriceFilter(100000, 200000, this)">100K - 200K</button>
            <button class="f-btn" onclick="setPriceFilter(200000, 500000, this)">200K - 500K</button>
            <button class="f-btn" onclick="setPriceFilter(500000, 1000000, this)">500K - 1TR</button>
            <button class="f-btn" onclick="setPriceFilter(1000000, 5000000, this)">1TR - 5TR</button>
            <button class="f-btn" onclick="setPriceFilter(5000000, 10000000, this)">5TR - 10TR</button>
            <button class="f-btn" onclick="setPriceFilter(10000000, 100000000, this)">TR√äN 10TR</button>
        </div>

        <div id="statusMsg" class="status-msg">üëâ B∆∞·ªõc 1: Ch·ªçn ng∆∞·ªùi nh·∫≠n -> B∆∞·ªõc 2: Ch·ªçn m·ª©c gi√°!</div>
        
        <div style="margin-bottom: 10px; display: flex; gap: 10px; flex-wrap: wrap;">
            <input type="file" id="csv" multiple accept=".csv">
            <button onclick="clearW()" style="background:#ff4136; color:white; border:none; padding:8px 12px; border-radius:6px; cursor:pointer;">üóëÔ∏è X√ìA S·∫†CH KHO</button>
            <button class="f-btn" style="border-color:var(--g); color:var(--g)" onclick="renderW()">üîÑ B·ªêC L·∫†I M√ìN KH√ÅC</button>
            <button class="f-btn" style="border-color:var(--v); color:var(--v)" onclick="exportJson()">üíæ XU·∫§T FILE CHO GITHUB</button>
        </div>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>S·∫£n ph·∫©m</th>
                        <th width="100">Gi√°</th>
                        <th width="150">Link GitHub</th>
                        <th width="150">Link Shopee</th>
                        <th width="150">ƒêƒÉng AI</th>
                    </tr>
                </thead>
                <tbody id="pArea"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    const fixedMems = [
        {n:"NGUY·ªÑN KH·∫ÆC NƒÇNG", d:"1944-06-04", g:"Nam"}, {n:"T√î TH·ªä H√Ä", d:"1948-08-29", g:"N·ªØ"},
        {n:"NGUY·ªÑN MINH NAM", d:"1971-03-03", g:"Nam"}, {n:"TH√ÇN TH·ªä KIM ANH", d:"1981-09-23", g:"N·ªØ"},
        {n:"NGUY·ªÑN T√î NG√ÇN AN", d:"2014-09-28", g:"N·ªØ"}, {n:"NGUY·ªÑN T√î MINH CH√ÇU", d:"2016-07-25", g:"N·ªØ"},
        {n:"NGUY·ªÑN T√î B√çCH NG·ªåC", d:"2020-02-05", g:"N·ªØ"}, {n:"NGUY·ªÑN TH·ªä MINH H·∫∞NG", d:"1974-01-07", g:"N·ªØ"},
        {n:"NG√î QU√ù C∆Ø·ªúNG", d:"1973-05-23", g:"Nam"}, {n:"NG√î GIA B√ÅCH", d:"2000-10-12", g:"Nam"},
        {n:"NG√î GIA LINH", d:"2005-04-05", g:"N·ªØ"}, {n:"NGUY·ªÑN TH·ªä MINH PH∆Ø∆†NG", d:"1978-11-06", g:"N·ªØ"},
        {n:"HO√ÄNG ANH D≈®NG", d:"1978-09-21", g:"Nam"}, {n:"HO√ÄNG H·∫¢I VINH", d:"2010-06-03", g:"Nam"},
        {n:"HO√ÄNG THI√äN B·∫†CH ANH", d:"2015-11-14", g:"N·ªØ"}, {n:"T√î KIM HU·ªÜ", d:"1960-08-09", g:"N·ªØ"},
        {n:"NGUY·ªÑN TU·∫§N ANH", d:"1983-10-23", g:"Nam"}, {n:"NGUY·ªÑN TH·∫æ ANH", d:"2001-03-24", g:"Nam"},
        {n:"NG√î TH·ªä MAI", d:"1948-12-12", g:"N·ªØ"}, {n:"T√î VI·ªÜT H∆ØNG", d:"1996-06-17", g:"Nam"},
        {n:"T√î TH·ªä H·ªíNG", d:"1964-10-10", g:"N·ªØ"}, {n:"V≈® VƒÇN HI·ªÜP", d:"1974-04-24", g:"Nam"},
        {n:"NGUY·ªÑN TH·ªä CHI", d:"1946-02-08", g:"N·ªØ"}, {n:"NGUY·ªÑN T√ÇN B·∫ÆC", d:"1957-11-30", g:"Nam"},
        {n:"NGUY·ªÑN TH·ªä T√ÇM", d:"1954-08-08", g:"N·ªØ"}, {n:"TH√ÇN VƒÇN GI·ªÆ", d:"1955-04-18", g:"Nam"},
        {n:"NGUY·ªÑN TH·ªä B√åNH", d:"1958-05-21", g:"N·ªØ"}, {n:"TH√ÇN TH·ªä B√çCH NGUY·ªÜT", d:"1980-05-21", g:"N·ªØ"},
        {n:"TH√ÇN VƒÇN TU·∫§N", d:"1983-05-21", g:"Nam"}, {n:"TH√ÇN Y·∫æN NHI", d:"2010-03-26", g:"N·ªØ"},
        {n:"L√ä TH·ªä PH∆Ø∆†NG", d:"1990-06-26", g:"N·ªØ"}, {n:"NGUY·ªÑN HO√ÄI NAM", d:"2004-06-02", g:"Nam"}
    ];

    let extraMems = JSON.parse(localStorage.getItem('extra_v18')) || [];
    let warehouse = JSON.parse(localStorage.getItem('war_v18')) || [];
    let selM = null;
    let priceRange = { min: 0, max: 999999999 };

    function saveAll() {
        localStorage.setItem('extra_v18', JSON.stringify(extraMems));
        localStorage.setItem('war_v18', JSON.stringify(warehouse));
        localStorage.setItem('gh_v18', document.getElementById('ghLink').value);
        localStorage.setItem('sh_v18', document.getElementById('shopeeLink').value);
    }

    function addM() {
        const n = document.getElementById('newName').value;
        const d = document.getElementById('newBirth').value;
        const g = document.getElementById('newGen').value;
        if(n && d) { 
            extraMems.unshift({n, d, g}); 
            document.getElementById('newName').value=""; 
            saveAll(); renderM(); 
        }
    }

    function delM(i) { extraMems.splice(i,1); saveAll(); renderM(); }

    function renderM() {
        const all = [...extraMems, ...fixedMems];
        document.getElementById('mList').innerHTML = all.map((m, i) => `
            <div style="position:relative">
                <button class="m-btn ${selM?.n === m.n ? 'active' : ''}" onclick='selectM(${JSON.stringify(m)})'>
                    <strong>${m.n}</strong>
                </button>
                ${i < extraMems.length ? `<button class="del-btn" onclick="delM(${i})">√ó</button>` : ''}
            </div>
        `).join('');
    }

    function selectM(m) {
        selM = m;
        selM.age = Math.floor((new Date() - new Date(m.d))/31557600000);
        const lastName = m.n.split(' ').pop();
        document.getElementById('statusMsg').innerHTML = `‚úÖ ƒê√£ ch·ªçn: <b>${m.n}</b>. T√™n c√≥ <b>${lastName.length}</b> ch·ªØ -> B·ªëc <b>${lastName.length}</b> m√≥n!`;
        renderM(); renderW();
    }

    function setPriceFilter(min, max, btn) {
        priceRange = { min, max };
        document.querySelectorAll('.f-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        renderW();
    }

    document.getElementById('csv').onchange = async (e) => {
        const files = Array.from(e.target.files);
        for (const file of files) {
            const text = await file.text();
            const lines = text.split('\n').slice(1);
            lines.forEach(l => {
                const c = l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                if(c.length >= 5) {
                    const id = c[0].trim();
                    const pStr = c[2]?.replace(/[^0-9]/g, '') || "0";
                    if(!warehouse.some(x => x.id === id)) {
                        warehouse.push({ id, name: c[1]?.replace(/"/g, '').split(' ').slice(0, 10).join(' ').trim(), price: parseInt(pStr) });
                    }
                }
            });
        }
        saveAll(); renderW();
    };

    function clearW() { if(confirm("X√≥a s·∫°ch kho h√†ng hi·ªán t·∫°i?")) { warehouse = []; saveAll(); renderW(); } }

    function renderW() {
        if(!selM) return;
        const area = document.getElementById('pArea');
        const limit = selM.n.split(' ').pop().length;
        let pool = warehouse.filter(p => p.price >= priceRange.min && p.price <= priceRange.max);
        let selected = pool.sort(() => 0.5 - Math.random()).slice(0, limit);

        if(selected.length === 0) {
            area.innerHTML = `<tr><td colspan="5">Kh√¥ng c√≥ h√†ng ·ªü m·ª©c gi√° n√†y. B·ªë h√£y n·∫°p CSV ho·∫∑c ch·ªçn m·ª©c gi√° kh√°c!</td></tr>`;
            return;
        }

        area.innerHTML = selected.map(p => {
            const gh = `${document.getElementById('ghLink').value}?id=${p.id}`;
            return `
            <tr>
                <td style="text-align:left;"><b>${p.name}</b></td>
                <td style="color:var(--p)"><b>${p.price.toLocaleString()}ƒë</b></td>
                <td><input type="text" value="${gh}" readonly style="width:120px; font-size:9px" onclick="this.select(); document.execCommand('copy'); alert('ƒê√£ copy link GitHub!')"></td>
                <td><input type="text" id="shopee_${p.id}" style="width:120px; font-size:9px" placeholder="D√°n link r√∫t g·ªçn..."></td>
                <td>
                    <button class="btn-ai" style="background:var(--gpt)" onclick="goAI('ChatGPT','${p.id}')">GPT</button>
                    <button class="btn-ai" style="background:var(--x)" onclick="goAI('Grok','${p.id}')">Grok</button>
                </td>
            </tr>`;
        }).join('');
    }

    function goAI(ai, id) {
        const p = warehouse.find(x => x.id === id);
        const gh = `${document.getElementById('ghLink').value}?id=${id}`;
        const sInput = document.getElementById(`shopee_${id}`).value;
        const finalS = sInput || document.getElementById('shopeeLink').value;
        
        let prompt = `Vi·∫øt b√†i ƒëƒÉng Facebook h√†i h∆∞·ªõc, √Ω nghƒ©a cho ${selM.n} (${selM.age} tu·ªïi) t·∫∑ng m√≥n ƒë·ªì ${p.name} gi√° ${p.price.toLocaleString()}ƒë.
üëâ Xem t·∫°i ƒë√¢y: ${gh}
${finalS ? `üõçÔ∏è Mua ngay: ${finalS}` : ''}`;

        navigator.clipboard.writeText(prompt).then(() => {
            alert(`ƒê√£ copy l·ªánh b√†i vi·∫øt cho ${ai}!`);
            const urls = {'ChatGPT':"https://chatgpt.com",'Grok':"https://x.com/i/grok"};
            window.open(urls[ai], "_blank");
        });
    }

    function exportJson() {
        const blob = new Blob([JSON.stringify(warehouse, null, 2)], {type: 'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'files.json'; a.click();
    }

    // T·∫£i d·ªØ li·ªáu c≈©
    if(localStorage.getItem('gh_v18')) document.getElementById('ghLink').value = localStorage.getItem('gh_v18');
    if(localStorage.getItem('sh_v18')) document.getElementById('shopeeLink').value = localStorage.getItem('sh_v18');
    renderM();
</script>
</body>
</html>
