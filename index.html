<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Marketing Gia ƒê√¨nh V18.8 - CHU·∫®N LOGIC</title>
    <style>
        :root { --p: #ee4d2d; --s: #1877F2; --v: #6c5ce7; --g: #00b894; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; }
        
        .step { background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border-left: 8px solid #ccc; }
        .s1 { border-color: #ff9f43; } .s2 { border-color: #a29bfe; } .s3 { border-color: #54a0ff; }
        .s4 { border-color: #ee4d2d; } .s5 { border-color: #00b894; } .s6 { border-color: #2d3436; }

        .num { background: #333; color: white; padding: 5px 12px; border-radius: 50%; font-weight: bold; margin-right: 10px; }
        .red-bold { color: red; font-size: 24px; font-weight: 900; text-decoration: underline; }
        
        /* L∆∞·ªõi s·∫£n ph·∫©m */
        .market { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 15px; }
        .card { background: white; border: 2px solid #eee; border-radius: 12px; overflow: hidden; cursor: pointer; transition: 0.3s; position: relative; }
        .card:hover { border-color: var(--p); transform: translateY(-5px); }
        .card img { width: 100%; height: 180px; object-fit: cover; background: #f9f9f9; }
        .card-info { padding: 12px; }
        
        /* Modal ƒëi·ªÅu khi·ªÉn */
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:999; }
        .modal-content { background: white; width: 90%; max-width: 500px; margin: 30px auto; padding: 20px; border-radius: 20px; text-align: center; }
        
        .btn { padding: 15px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; color: white; width: 100%; margin: 5px 0; }
        .btn-shopee { background: var(--p); font-size: 18px; }
        .btn-ai { font-size: 14px; width: 48%; display: inline-block; }
    </style>
</head>
<body>

<h1 style="text-align:center; color: var(--v);">üöÄ H·ªÜ TH·ªêNG MARKETING 3 ANH EM (V18.8)</h1>

<div class="step s1">
    <h2><span class="num">1</span> N·∫†P KHO H√ÄNG (CSV)</h2>
    <input type="file" id="csv" accept=".csv" style="width:100%">
    <p style="font-size:12px; color: #666;">B·ªë h√£y ch·ªçn file CSV c√≥ ch·ª©a: ID, T√™n, Gi√°, Link ·∫¢nh, Link G·ªëc.</p>
</div>

<div class="step s2">
    <h2><span class="num">2</span> NG∆Ø·ªúI MAY M·∫ÆN H√îM NAY</h2>
    <div id="luckyName" style="font-size: 28px; font-weight: bold;">---</div>
    <div id="luckyDetail" style="color: #666;"></div>
</div>

<div class="step s3">
    <h2><span class="num">3</span> CH·ªåN QU√Ä PH√ô H·ª¢P (·∫¢NH TH·∫¨T)</h2>
    <div style="margin-bottom:15px; display: flex; gap: 10px;">
        <button onclick="renderMarket(0,50000)">T·∫ßng L</button>
        <button onclick="renderMarket(50000,200000)">T·∫ßng T</button>
        <button onclick="renderMarket(200000,1000000)">T·∫ßng D</button>
        <button onclick="renderMarket(1000000,99999999)">T·∫ßng C</button>
    </div>
    <div id="market" class="market"></div>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <img id="mImg" style="width:200px; height:200px; border-radius:15px; object-fit: cover;">
        <h3 id="mTitle"></h3>
        
        <div style="background: #fff0f0; padding: 15px; border-radius: 15px;">
            <h3><span class="num">4</span> L·∫§Y LINK G·ªêC</h3>
            <button class="btn btn-shopee" onclick="window.open('https://affiliate.shopee.vn/offer/custom_link', '_blank')">M·ªû SHOPEE R√öT G·ªåN</button>
            <p style="font-size:12px;">(M√°y ƒë√£ t·ª± copy link g·ªëc, b√© ch·ªâ c·∫ßn sang d√°n th√¥i!)</p>
        </div>

        <div style="background: #f0f7ff; padding: 15px; border-radius: 15px; margin-top:10px;">
            <h3><span class="num">5</span> VI·∫æT B√ÄI V·ªöI AI</h3>
            <input type="text" id="affInput" style="width:100%; padding:12px; border-radius:8px; border:2px solid #54a0ff;" placeholder="D√°n link r√∫t g·ªçn m√†u xanh v√†o ƒë√¢y...">
            <div style="margin-top:10px;">
                <button class="btn btn-ai" style="background:#10a37f" onclick="askAI('ChatGPT')">ChatGPT</button>
                <button class="btn btn-ai" style="background:#4285f4" onclick="askAI('Gemini')">Gemini</button>
                <button class="btn btn-ai" style="background:#000" onclick="askAI('Grok')">Grok</button>
                <button class="btn btn-ai" style="background:#6a1b9a" onclick="askAI('DeepSeek')">DeepSeek</button>
            </div>
        </div>
        <button onclick="document.getElementById('modal').style.display='none'" style="margin-top:15px; cursor:pointer;">‚ùå ƒê√ìNG</button>
    </div>
</div>

<div class="step s6">
    <h2><span class="num">6</span> XU·∫§T FILE GITHUB</h2>
    <button class="btn" style="background: #2d3436;" onclick="exportJson()">üíæ XU·∫§T FILE FILES.JSON</button>
</div>

<script>
    const fixedMems = [
        {n:"NGUY·ªÑN KH·∫ÆC NƒÇNG", d:"1944-06-04", g:"Nam", cat:"Ng∆∞·ªùi gi√†"}, 
        {n:"T√î TH·ªä H√Ä", d:"1948-08-29", g:"N·ªØ", cat:"Ng∆∞·ªùi gi√†"},
        {n:"NGUY·ªÑN MINH NAM", d:"1971-03-03", g:"Nam", cat:"Trung ni√™n"},
        {n:"TH√ÇN TH·ªä KIM ANH", d:"1981-09-23", g:"N·ªØ", cat:"Trung ni√™n"},
        {n:"NGUY·ªÑN T√î NG√ÇN AN", d:"2014-09-28", g:"N·ªØ", cat:"Tr·∫ª em"},
        {n:"NGUY·ªÑN T√î MINH CH√ÇU", d:"2016-07-25", g:"N·ªØ", cat:"Tr·∫ª em"},
        {n:"NGUY·ªÑN T√î B√çCH NG·ªåC", d:"2020-02-05", g:"N·ªØ", cat:"Tr·∫ª em"}
    ];

    let warehouse = [];
    let lucky = null;
    let selected = null;

    // 1. T·ª± ƒë·ªông ch·ªçn ng∆∞·ªùi theo ng√†y (V√≤ng l·∫∑p c√¥ng b·∫±ng)
    function pickLucky() {
        const offset = Math.floor((new Date() - new Date("2026-01-01")) / (1000*60*60*24));
        lucky = fixedMems[offset % fixedMems.length];
        const lastChar = lucky.n.trim().slice(-1);
        document.getElementById('luckyName').innerHTML = lucky.n.slice(0,-1) + `<span class="red-bold">${lastChar}</span>`;
        document.getElementById('luckyDetail').innerText = `Gi·ªõi t√≠nh: ${lucky.g} | Nh√≥m: ${lucky.cat} | NƒÉm sinh: ${lucky.d.split('-')[0]}`;
    }

    // 2. ƒê·ªçc CSV v√† x·ª≠ l√Ω ·∫¢nh
    document.getElementById('csv').onchange = async (e) => {
        const file = e.target.files[0];
        const text = await file.text();
        const lines = text.split('\n').slice(1);
        warehouse = lines.map(l => {
            const c = l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
            if(c.length >= 5) {
                return {
                    id: c[0].trim(),
                    name: c[1].replace(/"/g, ''),
                    price: parseInt(c[2].replace(/[^0-9]/g, '')),
                    img: c[3]?.trim().replace(/"/g, '') || 'https://via.placeholder.com/200',
                    link: c[c.length-1].trim().replace(/"/g, ''),
                    aff: ""
                };
            }
        }).filter(x => x);
        renderMarket(0, 99999999);
    };

    // 3. Hi·ªán si√™u th·ªã qu√† - T√¥ ƒë·∫≠m ch·ªØ cu·ªëi
    function renderMarket(min, max) {
        const area = document.getElementById('market');
        area.innerHTML = "";
        const char = lucky.n.trim().slice(-1).toUpperCase();

        warehouse.filter(p => p.price >= min && p.price <= max).forEach(p => {
            const pChar = p.name.trim().slice(-1).toUpperCase();
            const isMatch = pChar === char;
            
            const card = document.createElement('div');
            card.className = 'card';
            card.onclick = () => {
                selected = p;
                document.getElementById('mImg').src = p.img;
                document.getElementById('mTitle').innerHTML = p.name.slice(0,-1) + `<span class="red-bold">${p.name.slice(-1)}</span>`;
                document.getElementById('modal').style.display = 'block';
                navigator.clipboard.writeText(p.link);
            };
            card.innerHTML = `
                <img src="${p.img}">
                <div class="card-info">
                    <div style="font-size:14px; height:40px; overflow:hidden;">
                        ${p.name.slice(0,-1)}<span class="${isMatch ? 'red-bold' : ''}">${p.name.slice(-1)}</span>
                    </div>
                    <div style="color:red; font-weight:bold; margin-top:5px;">${p.price.toLocaleString()}ƒë</div>
                </div>
            `;
            area.appendChild(card);
        });
    }

    // 4. Vi·∫øt b√†i AI - S·ª≠a l·ªói sai t√™n v√† gi·ªõi t√≠nh
    function askAI(type) {
        const aff = document.getElementById('affInput').value;
        if(!aff) return alert("D√°n link r√∫t g·ªçn v√†o ƒë√£!");
        
        selected.aff = aff;
        const ghUrl = `https://namnguyen7133-png.github.io/cua-hang-di-dong/001-kho-hang.html?id=${selected.id}`;
        
        // PROMPT CHU·∫®N: L·∫•y ƒë√∫ng t√™n Lucky
        const prompt = `H√£y ƒë√≥ng vai m·ªôt b√© thi·∫øu nhi, vi·∫øt m·ªôt truy·ªán ng·ª• ng√¥n h√†i h∆∞·ªõc v·ªÅ nh√¢n v·∫≠t ch√≠nh l√† ${lucky.n} (Gi·ªõi t√≠nh: ${lucky.g}, thu·ªôc nh√≥m ${lucky.cat}). 
        V√¨ duy√™n n·ª£ ch·ªØ c√°i cu·ªëi c·ªßa t√™n l√† "${lucky.n.slice(-1)}" tr√πng v·ªõi ch·ªØ c√°i cu·ªëi c·ªßa m√≥n qu√† "${selected.name}", n√™n ƒë·ªãnh m·ªánh ƒë√£ ch·ªçn m√≥n qu√† n√†y t·∫∑ng ${lucky.n}.
        K·∫øt b√†i: M·ªùi m·ªçi ng∆∞·ªùi b·∫•m v√†o link GitHub n√†y ƒë·ªÉ xem s·ª± t√≠ch v√† mua ·ªßng h·ªô: ${ghUrl} (D·∫∑n m·ªçi ng∆∞·ªùi d√πng 4G ƒë·ªÉ h·ªá th·ªëng ghi nh·∫≠n ch√≠nh x√°c ·∫°).`;

        navigator.clipboard.writeText(prompt);
        alert(`ƒê√£ copy b√†i vi·∫øt cho ${lucky.n}! ƒêang m·ªü ${type}...`);
        
        const urls = { 
            ChatGPT: "https://chatgpt.com", 
            Gemini: "https://gemini.google.com", 
            Grok: "https://x.com/i/grok", 
            DeepSeek: "https://chat.deepseek.com" 
        };
        window.open(urls[type], "_blank");
    }

    function exportJson() {
        const blob = new Blob([JSON.stringify(warehouse, null, 2)], {type: 'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'files.json'; a.click();
    }

    pickLucky();
</script>
</body>
</html>
