<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>H·ªá Th·ªëng Marketing Gia ƒê√¨nh - Link GitHub Auto</title>
    <style>
        :root { --p: #ee4d2d; --s: #1877F2; --v: #9b59b6; --g: #27ae60; --dark: #2d3436; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; padding: 20px; }
        .box { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .member-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 10px; margin: 15px 0; max-height: 250px; overflow-y: auto; padding: 10px; border: 1px inset #eee; }
        .m-btn { padding: 10px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; background: #fff; font-size: 11px; position: relative; }
        .m-btn.active { background: var(--v); color: white; font-weight: bold; }
        .del-btn { position: absolute; top: 0; right: 0; background: red; color: white; border: none; border-radius: 50%; width: 18px; height: 18px; cursor: pointer; }
        
        /* √î nh·∫≠p link GitHub */
        .config-row { background: #fff3bf; padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 2px solid #fab005; }
        input { padding: 8px; border: 1px solid #ddd; border-radius: 5px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: var(--dark); color: white; padding: 10px; }
        td { border-bottom: 1px solid #eee; padding: 10px; text-align: center; }
        .btn { border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; color: white; font-weight: bold; }
        .btn-ai { font-size: 10px; margin: 2px; width: 80px; }
    </style>
</head>
<body>

<div style="max-width: 1100px; margin: auto;">
    <h1 style="text-align: center; color: var(--p);">üöÄ TR·∫†M ƒêI·ªÄU H√ÄNH MARKETING GIA ƒê√åNH</h1>

    <div class="box config-row">
        <strong>üåê ƒê·ªäA CH·ªà WEB GITHUB C·ª¶A B·∫†N:</strong><br>
        <input type="text" id="ghBase" style="width: 80%; margin-top: 5px;" 
               placeholder="V√≠ d·ª•: https://namnguyen7133.github.io/kho-hang/" 
               value="https://namnguyen7133.github.io/kho-hang/" onchange="saveGH()">
        <p style="font-size: 11px; color: #666; margin: 5px 0 0 0;">(H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông d√πng link n√†y ƒë·ªÉ c√°c b√© ƒëƒÉng b√†i Facebook)</p>
    </div>

    <div class="box">
        <h2>1. CH·ªåN NG∆Ø·ªúI NH·∫¨N</h2>
        <div style="margin-bottom: 10px;">
            <input type="text" id="inN" placeholder="T√™n...">
            <input type="date" id="inD">
            <button class="btn" style="background:var(--g)" onclick="addM()">+ Th√™m Ng∆∞·ªùi</button>
            <button class="btn" style="background:#ff4757" onclick="clearM()">üóëÔ∏è X√≥a h·∫øt kh√°ch</button>
        </div>
        <div class="member-grid" id="mList"></div>
    </div>

    <div class="box">
        <h2>2. CH·ªåN S·∫¢N PH·∫®M & AI K·ªÇ CHUY·ªÜN</h2>
        <input type="file" id="csv" multiple accept=".csv" style="margin-bottom:10px">
        <table>
            <thead>
                <tr>
                    <th>T√™n SP</th>
                    <th>Link GitHub G·ªëc (T·ª± t·∫°o)</th>
                    <th>G·ªçi AI (T·ª± Copy Prompt)</th>
                </tr>
            </thead>
            <tbody id="pArea"></tbody>
        </table>
        <div style="margin-top: 20px;">
             <button class="btn" style="background:var(--s)" onclick="exportJson()">üíæ Xu·∫•t files.json cho GitHub</button>
        </div>
    </div>
</div>

<script>
    const fixedM = [
        {n:"NGUY·ªÑN KH·∫ÆC NƒÇNG", d:"1944-06-04", g:"Nam"}, {n:"T√î TH·ªä H√Ä", d:"1948-08-29", g:"N·ªØ"},
        {n:"NGUY·ªÑN MINH NAM", d:"1971-03-03", g:"Nam"}, {n:"TH√ÇN TH·ªä KIM ANH", d:"1981-09-23", g:"N·ªØ"}
        // ... (B·∫°n h√£y d√°n n·ªët 32 ng∆∞·ªùi c·ªßa b·∫°n v√†o ƒë√¢y nh√©)
    ];

    let extraM = JSON.parse(localStorage.getItem('extraM')) || [];
    let warehouse = JSON.parse(localStorage.getItem('wareV4')) || [];
    let activeM = null;
    let ghBase = localStorage.getItem('ghBase') || "https://namnguyen7133.github.io/kho-hang/";

    function saveGH() { 
        ghBase = document.getElementById('ghBase').value; 
        if(!ghBase.endsWith('/')) ghBase += '/';
        localStorage.setItem('ghBase', ghBase); 
        renderW(); 
    }

    function renderM() {
        const list = document.getElementById('mList');
        const all = [...extraM, ...fixedM];
        list.innerHTML = all.map((m, i) => `
            <div style="position:relative">
                <button class="m-btn ${activeM && activeM.n === m.n ? 'active' : ''}" onclick='activeM=${JSON.stringify(m)};renderM()'>
                    <b>${m.n}</b><br><small>${m.g} - ${calcAge(m.d)}t</small>
                </button>
                ${i < extraM.length ? `<button class="del-btn" onclick="delM(${i})">√ó</button>` : ''}
            </div>
        `).join('');
    }

    function calcAge(d) { return Math.floor((new Date() - new Date(d))/31557600000); }

    function addM() {
        const n = document.getElementById('inN').value;
        const d = document.getElementById('inD').value;
        if(!n || !d) return alert("Nh·∫≠p ƒë·ªß t√™n, ng√†y sinh!");
        extraM.unshift({n, d, g:"Nam"});
        localStorage.setItem('extraM', JSON.stringify(extraM));
        renderM();
    }

    function delM(i) { extraM.splice(i,1); localStorage.setItem('extraM', JSON.stringify(extraM)); renderM(); }
    function clearM() { extraM=[]; localStorage.setItem('extraM','[]'); renderM(); }

    document.getElementById('csv').onchange = async (e) => {
        const files = Array.from(e.target.files);
        for (const file of files) {
            const text = await file.text();
            const lines = text.split('\n').slice(1);
            lines.forEach(l => {
                const c = l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                if(c.length >= 8) {
                    const id = c[0].trim();
                    if(!warehouse.some(p => p.id === id)) {
                        warehouse.push({ id, n: c[1]?.replace(/"/g, '').split(' ').slice(0, 5).join(' ').trim() });
                    }
                }
            });
        }
        renderW();
    };

    function renderW() {
        const area = document.getElementById('pArea');
        area.innerHTML = warehouse.slice(-10).reverse().map(p => {
            // T·ª∞ T·∫†O LINK GITHUB: Link Base + m√£ s·∫£n ph·∫©m
            // V√≠ d·ª•: https://.../index.html?id=123
            const myGitHubLink = `${ghBase}index.html?id=${p.id}`;
            return `
                <tr>
                    <td style="font-size:12px">${p.n}</td>
                    <td><input value="${myGitHubLink}" readonly style="width:90%; font-size:10px; color:blue; border:none; background:none;"></td>
                    <td>
                        <button class="btn btn-ai" style="background:var(--v)" onclick="goAI('DeepSeek', '${p.id}', '${myGitHubLink}')">DeepSeek</button>
                        <button class="btn btn-ai" style="background:var(--s)" onclick="goAI('Gemini', '${p.id}', '${myGitHubLink}')">Gemini</button>
                    </td>
                </tr>
            `;
        }).join('');
    }

    function goAI(ai, id, finalLink) {
        if(!activeM) return alert("B√© ch·ªçn ng∆∞·ªùi nh·∫≠n tr∆∞·ªõc!");
        const p = warehouse.find(x => x.id === id);
        const age = calcAge(activeM.d);
        
        const prompt = `Vi·∫øt b√†i ƒëƒÉng Facebook c·ª±c vui k·ªÉ v·ªÅ ${activeM.n} (${age} tu·ªïi). 
Trong truy·ªán c√≥ d√πng: ${p.n}. 
K√™u g·ªçi m·ªçi ng∆∞·ªùi xem ·∫£nh v√† gi√° t·∫°i link GitHub gia ƒë√¨nh em: ${finalLink}`;

        navigator.clipboard.writeText(prompt).then(() => {
            alert(`‚úÖ ƒê√É COPY L·ªÜNH!\nB√© sang d√°n v√†o ${ai} nh√©.`);
            const urls = { 'DeepSeek': "https://chat.deepseek.com", 'Gemini': "https://gemini.google.com/app" };
            window.open(urls[ai], '_blank');
        });
    }

    function exportJson() {
        const blob = new Blob([JSON.stringify(warehouse, null, 2)], {type: 'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'files.json'; a.click();
    }

    renderM();
    renderW();
</script>
</body>
</html>
