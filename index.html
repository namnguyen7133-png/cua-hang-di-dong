<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Si√™u Th·ªã Marketing Nh√≠ V18.6</title>
    <style>
        :root { --p: #ee4d2d; --s: #1877f2; --g: #00b894; --gold: #f1c40f; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        
        /* Khu v·ª±c ng∆∞·ªùi may m·∫Øn - To, n·ªïi b·∫≠t */
        .lucky-banner { background: linear-gradient(135deg, #6c5ce7, #a29bfe); color: white; padding: 20px; border-radius: 20px; text-align: center; margin-bottom: 20px; box-shadow: 0 10px 20px rgba(108,92,231,0.3); }
        .lucky-name { font-size: 32px; font-weight: bold; margin: 10px 0; }
        .highlight-char { background: var(--p); color: white; padding: 0 10px; border-radius: 5px; font-size: 40px; display: inline-block; animation: pulse 1s infinite; }
        
        /* Danh s√°ch s·∫£n ph·∫©m d·∫°ng l∆∞·ªõi gi·ªëng FB/Zalo */
        .product-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; margin-top: 20px; }
        .product-card { background: white; border-radius: 15px; overflow: hidden; transition: 0.3s; border: 2px solid transparent; position: relative; display: flex; flex-direction: column; }
        .product-card:hover { transform: translateY(-5px); border-color: var(--s); box-shadow: 0 10px 15px rgba(0,0,0,0.1); }
        .product-img { width: 100%; height: 200px; object-fit: cover; background: #eee; }
        .product-info { padding: 15px; flex-grow: 1; }
        .product-name { font-weight: bold; font-size: 16px; margin-bottom: 5px; height: 45px; overflow: hidden; }
        .product-price { color: var(--p); font-size: 18px; font-weight: bold; }
        
        /* Ch·ªØ c√°i ƒë·ªãnh m·ªánh */
        .destiny-char { color: var(--p); font-size: 22px; font-weight: 900; text-decoration: underline; }
        
        /* Tr·∫°m ƒëi·ªÅu khi·ªÉn */
        .control-panel { background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px; display: flex; gap: 15px; align-items: center; flex-wrap: wrap; }
        .btn { padding: 12px 20px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; color: white; }
        .btn-shopee { background: var(--p); }
        .btn-ai { background: var(--g); }
        .btn-git { background: #2d3436; }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="lucky-banner" id="banner">
    <div>üåü NG∆Ø·ªúI MAY M·∫ÆN H√îM NAY (THEO TH·ª® T·ª∞) üåü</div>
    <div class="lucky-name" id="luckyDisplay">ƒêang t√≠nh to√°n...</div>
    <p id="destinyHint"></p>
</div>

<div class="control-panel">
    <input type="file" id="csv" multiple accept=".csv" title="N·∫°p h√†ng t·ª´ b·ªë">
    <select id="priceFilter" onchange="renderProducts()" style="padding:10px; border-radius:8px;">
        <option value="all">T·∫•t c·∫£ gi√°</option>
        <option value="L">L (D∆∞·ªõi 50k)</option>
        <option value="T">T (50k - 200k)</option>
        <option value="D">D (200k - 1tr)</option>
        <option value="C">C (Tr√™n 1tr)</option>
    </select>
    <button class="btn btn-shopee" onclick="window.open('https://affiliate.shopee.vn/offer/custom_link', '_blank')">‚ÜóÔ∏è M·ªü Shopee R√∫t G·ªçn</button>
    <button class="btn btn-git" onclick="exportJson()">üíæ Xu·∫•t File GitHub</button>
</div>

<div id="market" class="product-grid"></div>

<div id="processModal" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:30px; border-radius:20px; box-shadow:0 0 100px rgba(0,0,0,0.5); z-index:100; width: 400px; text-align:center;">
    <h2 id="modalTitle">X·ª≠ l√Ω s·∫£n ph·∫©m</h2>
    <p>B∆∞·ªõc 1: Link g·ªëc ƒë√£ ƒë∆∞·ª£c copy!</p>
    <input type="text" id="affInput" placeholder="D√°n link r√∫t g·ªçn v√†o ƒë√¢y..." style="width:100%; padding:10px; margin:15px 0;">
    <div class="ai-group" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <button class="btn btn-ai" onclick="goAI('chatgpt')">ChatGPT</button>
        <button class="btn btn-ai" onclick="goAI('gemini')">Gemini</button>
        <button class="btn btn-ai" onclick="goAI('grok')">Grok</button>
        <button class="btn btn-ai" onclick="goAI('deepseek')">DeepSeek</button>
    </div>
    <br>
    <button onclick="closeModal()">ƒê√≥ng</button>
</div>

<script>
    const fixedMems = [
        {n:"NGUY·ªÑN KH·∫ÆC NƒÇNG", d:"1944-06-04", g:"Nam"}, {n:"T√î TH·ªä H√Ä", d:"1948-08-29", g:"N·ªØ"},
        {n:"NGUY·ªÑN MINH NAM", d:"1971-03-03", g:"Nam"}, {n:"TH√ÇN TH·ªä KIM ANH", d:"1981-09-23", g:"N·ªØ"},
        {n:"NGUY·ªÑN T√î NG√ÇN AN", d:"2014-09-28", g:"N·ªØ"}, {n:"NGUY·ªÑN T√î MINH CH√ÇU", d:"2016-07-25", g:"N·ªØ"},
        {n:"NGUY·ªÑN T√î B√çCH NG·ªåC", d:"2020-02-05", g:"N·ªØ"}, {n:"NGUY·ªÑN TH·ªä MINH H·∫∞NG", d:"1974-01-07", g:"N·ªØ"},
        {n:"NG√î QU√ù C∆Ø·ªúNG", d:"1973-05-23", g:"Nam"}, {n:"NG√î GIA B√ÅCH", d:"2000-10-12", g:"Nam"},
        {n:"NG√î GIA LINH", d:"2005-04-05", g:"N·ªØ"}, {n:"NGUY·ªÑN TH·ªä MINH PH∆Ø∆†NG", d:"1978-11-06", g:"N·ªØ"},
        {n:"HO√ÄNG ANH D≈®NG", d:"1978-09-21", g:"Nam"}, {n:"HO√ÄNG H·∫¢I VINH", d:"2010-06-03", g:"Nam"},
        {n:"HO√ÄNG THI√äN B·∫†CH ANH", d:"2015-11-14", g:"N·ªØ"}, {n:"T√î KIM HU·ªÜ", d:"1960-08-09", g:"N·ªØ"},
        {n:"NGUY·ªÑN TU·∫§N ANH", d:"1983-10-23", g:"Nam"}, {n:"NGUY·ªÑN TH·∫æ ANH", d:"2001-03-24", g:"Nam"},
        {n:"NG√î TH·ªä MAI", d:"1948-12-12", g:"N·ªØ"}, {n:"T√î VI·ªÜT H∆ØNG", d:"1996-06-17", g:"Nam"},
        {n:"T√î TH·ªä H·ªíNG", d:"1964-10-10", g:"N·ªØ"}, {n:"V≈® VƒÇN HI·ªÜP", d:"1974-04-24", g:"Nam"},
        {n:"NGUY·ªÑN TH·ªä CHI", d:"1946-02-08", g:"N·ªØ"}, {n:"NGUY·ªÑN T√ÇN B·∫ÆC", d:"1957-11-30", g:"Nam"},
        {n:"NGUY·ªÑN TH·ªä T√ÇM", d:"1954-08-08", g:"N·ªØ"}, {n:"TH√ÇN VƒÇN GI·ªÆ", d:"1955-04-18", g:"Nam"},
        {n:"NGUY·ªÑN TH·ªä B√åNH", d:"1958-05-21", g:"N·ªØ"}, {n:"TH√ÇN TH·ªä B√çCH NGUY·ªÜT", d:"1980-05-21", g:"N·ªØ"},
        {n:"TH√ÇN VƒÇN TU·∫§N", d:"1983-05-21", g:"Nam"}, {n:"TH√ÇN Y·∫æN NHI", d:"2010-03-26", g:"N·ªØ"},
        {n:"L√ä TH·ªä PH∆Ø∆†NG", d:"1990-06-26", g:"N·ªØ"}, {n:"NGUY·ªÑN HO√ÄI NAM", d:"2004-06-02", g:"Nam"}
    ];

    let warehouse = JSON.parse(localStorage.getItem('war_v18_6')) || [];
    let currentLucky = null;
    let selectedProd = null;

    // 1. T·ª∞ ƒê·ªòNG CH·ªåN NG∆Ø·ªúI THEO NG√ÄY (TH·ª® T·ª∞ XOAY V√íNG)
    function pickLucky() {
        const dayOffset = Math.floor((new Date() - new Date("2026-01-01")) / (1000 * 60 * 60 * 24));
        currentLucky = fixedMems[dayOffset % fixedMems.length];
        
        const name = currentLucky.n;
        const lastChar = name.trim().slice(-1);
        document.getElementById('luckyDisplay').innerHTML = 
            name.slice(0, -1) + `<span class="highlight-char">${lastChar}</span>`;
        document.getElementById('destinyHint').innerHTML = 
            `B√© h√£y ch·ªçn qu√† n√†o c√≥ ch·ªØ k·∫øt th√∫c l√† <b style="font-size:20px; color:yellow;">${lastChar}</b> nh√©!`;
    }

    // 2. X·ª¨ L√ù CSV & HI·ªÜN ·∫¢NH
    document.getElementById('csv').onchange = async (e) => {
        const files = Array.from(e.target.files);
        for (const file of files) {
            const text = await file.text();
            const lines = text.split('\n').slice(1);
            lines.forEach(l => {
                const c = l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                if(c.length >= 5) {
                    const id = c[0].trim();
                    if(!warehouse.some(x => x.id === id)) {
                        warehouse.push({
                            id: id,
                            name: c[1].replace(/"/g, ''),
                            price: parseInt(c[2].replace(/[^0-9]/g, '')),
                            img: c[3]?.replace(/"/g, '') || 'https://via.placeholder.com/200', // Gi·∫£ ƒë·ªãnh c·ªôt 4 l√† ·∫£nh
                            link: c[c.length-1].replace(/"/g, '').trim(),
                            aff: ""
                        });
                    }
                }
            });
        }
        localStorage.setItem('war_v18_6', JSON.stringify(warehouse));
        renderProducts();
    };

    // 3. RENDER SI√äU TH·ªä
    function renderProducts() {
        const filter = document.getElementById('priceFilter').value;
        const lastChar = currentLucky.n.trim().slice(-1).toUpperCase();
        const market = document.getElementById('market');
        market.innerHTML = "";

        warehouse.forEach(p => {
            const pLastChar = p.name.trim().slice(-1).toUpperCase();
            const pPrice = p.price;
            let level = "";
            if(pPrice < 50000) level="L";
            else if(pPrice < 200000) level="T";
            else if(pPrice < 1000000) level="D";
            else level="C";

            if(filter !== 'all' && filter !== level) return;

            const isMatch = pLastChar === lastChar;
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <img src="${p.img}" class="product-img">
                <div class="product-info">
                    <div class="product-name">
                        ${p.name.slice(0, -1)}<span class="${isMatch ? 'destiny-char' : ''}">${p.name.slice(-1)}</span>
                    </div>
                    <div class="product-price">${pPrice.toLocaleString()}ƒë</div>
                    <button class="btn btn-shopee" style="width:100%; margin-top:10px;" onclick="openProcess('${p.id}')">CH·ªåN QU√Ä N√ÄY</button>
                </div>
            `;
            market.appendChild(card);
        });
    }

    function openProcess(id) {
        selectedProd = warehouse.find(x => x.id === id);
        navigator.clipboard.writeText(selectedProd.link);
        document.getElementById('modalTitle').innerText = selectedProd.name;
        document.getElementById('processModal').style.display = 'block';
        document.getElementById('affInput').value = selectedProd.aff || "";
    }

    function closeModal() {
        selectedProd.aff = document.getElementById('affInput').value;
        localStorage.setItem('war_v18_6', JSON.stringify(warehouse));
        document.getElementById('processModal').style.display = 'none';
    }

    function goAI(type) {
        const aff = document.getElementById('affInput').value;
        if(!aff) return alert("D√°n link r√∫t g·ªçn v√†o ƒë√£ b√© ∆°i!");
        
        const ghUrl = `https://namnguyen7133-png.github.io/cua-hang-di-dong/001-kho-hang.html?id=${selectedProd.id}`;
        const prompt = `Vi·∫øt m·ªôt c√¢u chuy·ªán ng·ª• ng√¥n h√†i h∆∞·ªõc v·ªÅ ${currentLucky.n}. V√¨ ch·ªØ c√°i cu·ªëi "${selectedProd.name.slice(-1)}" m√† ƒë·ªãnh m·ªánh t·∫∑ng qu√† "${selectedProd.name}". Link xem qu√†: ${ghUrl}`;
        
        navigator.clipboard.writeText(prompt);
        alert("ƒê√£ copy l·ªùi d·∫´n! ƒêang m·ªü AI...");
        const urls = { chatgpt: "https://chatgpt.com", gemini: "https://gemini.google.com", grok: "https://x.com/i/grok", deepseek: "https://chat.deepseek.com" };
        window.open(urls[type], "_blank");
    }

    function exportJson() {
        const blob = new Blob([JSON.stringify(warehouse, null, 2)], {type: 'application/json'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'files.json'; a.click();
    }

    pickLucky();
</script>
</body>
</html>
