<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>H·ªá Th·ªëng Marketing Gia ƒê√¨nh - B·∫£n Chu·∫©n 32 Th√†nh Vi√™n</title>
    <style>
        :root { --p: #ee4d2d; --s: #1877F2; --v: #9b59b6; --g: #27ae60; --dark: #2d3436; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #f4f7f6; margin: 0; padding: 20px; }
        .box { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h2 { color: var(--p); border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 0; }
        .step-num { background: var(--dark); color: white; padding: 5px 12px; border-radius: 50%; margin-right: 10px; }
        
        /* Grid danh s√°ch 32 ng∆∞·ªùi */
        .member-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; margin: 15px 0; }
        .m-btn { padding: 10px; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; background: #fff; font-size: 11px; text-align: left; transition: 0.3s; }
        .m-btn:hover { border-color: var(--s); background: #f0f7ff; }
        .m-btn.active { background: var(--v); color: white; border-color: var(--v); box-shadow: 0 4px 10px rgba(155, 89, 182, 0.4); }

        /* B·∫£ng h√†ng h√≥a */
        .table-wrap { overflow-x: auto; border-radius: 10px; margin-top: 15px; }
        table { width: 100%; border-collapse: collapse; background: white; min-width: 900px; }
        th { background: var(--dark); color: white; padding: 12px; font-size: 13px; }
        td { border-bottom: 1px solid #eee; padding: 10px; text-align: center; }
        
        input { padding: 8px; border: 1px solid #ddd; border-radius: 5px; }
        .edit-name { width: 90%; font-weight: bold; color: var(--s); }
        .aff-link { width: 90%; border: 1.5px solid #ff7675; background: #fff5f5; font-size: 11px; color: #d63031; }

        .btn { border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; color: white; font-weight: bold; font-size: 11px; }
        .img-slot { width: 60px; height: 60px; border: 2px dashed #ccc; border-radius: 8px; margin: auto; display: flex; align-items: center; justify-content: center; cursor: pointer; overflow: hidden; }
        .img-slot img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body>

<div style="max-width: 1200px; margin: auto;">
    <h1 style="text-align: center; color: var(--p);">üè™ H·ªÜ TH·ªêNG AFFILIATE GIA ƒê√åNH 2026</h1>

    <div class="box" id="step1">
        <h2><span class="step-num">1</span> CH·ªåN NG∆Ø·ªúI NH·∫¨N (∆Øu ti√™n sinh nh·∫≠t)</h2>
        <div class="member-grid" id="memberList"></div>
        <p id="selectedShow" style="font-weight:bold; color:var(--v); text-align:center; font-size: 18px;">üëâ H√£y ch·ªçn m·ªôt ng∆∞·ªùi ƒë·ªÉ b·∫Øt ƒë·∫ßu!</p>
    </div>

    <div class="box">
        <h2><span class="step-num">2</span> NH·∫¨P KHO CSV Shopee (Ch·ªçn nhi·ªÅu file)</h2>
        <input type="file" id="csvFiles" multiple accept=".csv" style="padding: 10px; background: #eee; border-radius: 8px; width: 300px;">
        <button class="btn" style="background:var(--dark); margin-left: 10px" onclick="exportJS()">üì§ Xu·∫•t File B√†y H√†ng (GitHub)</button>
        <span id="storageNote" style="font-size: 12px; margin-left: 10px; color: #666;"></span>
    </div>

    <div class="box">
        <h2><span class="step-num">3</span> BI√äN T·∫¨P & K·ªÇ CHUY·ªÜN AI</h2>
        <div class="table-wrap">
            <table>
                <thead>
                    <tr>
                        <th width="80">·∫¢nh</th>
                        <th>B√© s·ª≠a T√™n ng·∫Øn</th>
                        <th width="250">Link Affiliate (B·ªë d√°n)</th>
                        <th>Ch·ªçn AI k·ªÉ truy·ªán</th>
                        <th width="60">Xong</th>
                    </tr>
                </thead>
                <tbody id="productArea"></tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // D·ªÆ LI·ªÜU CHU·∫®N 32 NG∆Ø·ªúI TH√ÇN
    const familyMembers = [
        {n:"NGUY·ªÑN KH·∫ÆC NƒÇNG", d:"1944-06-04", g:"Nam", c:"n c g"}, {n:"T√î TH·ªä H√Ä", d:"1948-08-29", g:"N·ªØ", c:"√¥ ·ªã √†"},
        {n:"NGUY·ªÑN MINH NAM", d:"1971-03-03", g:"Nam", c:"n h m"}, {n:"TH√ÇN TH·ªä KIM ANH", d:"1981-09-23", g:"N·ªØ", c:"n ·ªã m h"},
        {n:"NGUY·ªÑN T√î NG√ÇN AN", d:"2014-09-28", g:"N·ªØ", c:"n √¥ n n"}, {n:"NGUY·ªÑN T√î MINH CH√ÇU", d:"2016-07-25", g:"N·ªØ", c:"n √¥ h u"},
        {n:"NGUY·ªÑN T√î B√çCH NG·ªåC", d:"2020-02-05", g:"N·ªØ", c:"n √¥ h c"}, {n:"NGUY·ªÑN TH·ªä MINH H·∫∞NG", d:"1974-01-07", g:"N·ªØ", c:"n ·ªã h g"},
        {n:"NG√î QU√ù C∆Ø·ªúNG", d:"1973-05-23", g:"Nam", c:"√¥ √Ω g"}, {n:"NG√î GIA B√ÅCH", d:"2000-10-12", g:"Nam", c:"√¥ a h"},
        {n:"NG√î GIA LINH", d:"2005-04-05", g:"N·ªØ", c:"√¥ a h"}, {n:"NGUY·ªÑN TH·ªä MINH PH∆Ø∆†NG", d:"1978-11-06", g:"N·ªØ", c:"n ·ªã h g"},
        {n:"HO√ÄNG ANH D≈®NG", d:"1978-09-21", g:"Nam", c:"g h g"}, {n:"HO√ÄNG H·∫¢I VINH", d:"2010-06-03", g:"Nam", c:"g i h"},
        {n:"HO√ÄNG THI√äN B·∫†CH ANH", d:"2015-11-14", g:"N·ªØ", c:"g n h h"}, {n:"T√î KIM HU·ªÜ", d:"1960-08-09", g:"N·ªØ", c:"√¥ m ·ªá"},
        {n:"NGUY·ªÑN TU·∫§N ANH", d:"1983-10-23", g:"Nam", c:"n n h"}, {n:"NGUY·ªÑN TH·∫æ ANH", d:"2001-03-24", g:"Nam", c:"n ·∫ø h"},
        {n:"NG√î TH·ªä MAI", d:"1948-12-12", g:"N·ªØ", c:"√¥ ·ªã i"}, {n:"T√î VI·ªÜT H∆ØNG", d:"1996-06-17", g:"Nam", c:"√¥ t g"},
        {n:"T√î TH·ªä H·ªíNG", d:"1964-10-10", g:"N·ªØ", c:"√¥ ·ªã g"}, {n:"V≈® VƒÇN HI·ªÜP", d:"1974-04-24", g:"Nam", c:"≈© n p"},
        {n:"NGUY·ªÑN TH·ªä CHI", d:"1946-02-08", g:"N·ªØ", c:"n ·ªã i"}, {n:"NGUY·ªÑN T√ÇN B·∫ÆC", d:"1957-11-30", g:"Nam", c:"n n c"},
        {n:"NGUY·ªÑN TH·ªä T√ÇM", d:"1954-08-08", g:"N·ªØ", c:"n ·ªã m"}, {n:"TH√ÇN VƒÇN GI·ªÆ", d:"1955-04-18", g:"Nam", c:"n n ·ªØ"},
        {n:"NGUY·ªÑN TH·ªä B√åNH", d:"1958-05-21", g:"N·ªØ", c:"n ·ªã h"}, {n:"TH√ÇN TH·ªä B√çCH NGUY·ªÜT", d:"1980-05-21", g:"N·ªØ", c:"n ·ªã h t"},
        {n:"TH√ÇN VƒÇN TU·∫§N", d:"1983-05-21", g:"Nam", c:"n n n"}, {n:"TH√ÇN Y·∫æN NHI", d:"2010-03-26", g:"N·ªØ", c:"n n i"},
        {n:"L√ä TH·ªä PH∆Ø∆†NG", d:"1990-06-26", g:"N·ªØ", √™:"√™ ·ªã g"}, {n:"NGUY·ªÑN HO√ÄI NAM", d:"2004-06-02", g:"Nam", c:"n i m"}
    ];

    let warehouse = JSON.parse(localStorage.getItem('familyWarehouse_2026') || '[]');
    let currentP = null;

    // T√≠nh tu·ªïi t·ª± ƒë·ªông
    function getAge(birthDate) {
        return Math.floor((new Date() - new Date(birthDate)) / 31557600000);
    }

    // Hi·ªÉn th·ªã 32 ng∆∞·ªùi
    function renderMembers() {
        const grid = document.getElementById('memberList');
        grid.innerHTML = familyMembers.map(m => `
            <button class="m-btn" onclick="selectMember('${m.n}', '${m.g}', '${m.d}')">
                <strong>${m.n}</strong><br>
                <small>${m.g} - ${getAge(m.d)} tu·ªïi</small>
            </button>
        `).join('');
    }

    function selectMember(name, gen, birth) {
        currentP = { name, gen, age: getAge(birth) };
        document.getElementById('selectedShow').innerText = `üéÅ ƒêang ch·ªçn: ${name} (${gen} - ${currentP.age} tu·ªïi)`;
        document.querySelectorAll('.m-btn').forEach(b => b.classList.toggle('active', b.innerText.includes(name)));
    }

    // X·ª≠ l√Ω CSV Shopee
    document.getElementById('csvFiles').onchange = async (e) => {
        const files = Array.from(e.target.files);
        for (const file of files) {
            const text = await file.text();
            const lines = text.split('\n').slice(1);
            lines.forEach(l => {
                const c = l.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                if(c.length >= 8) {
                    const id = c[0].trim();
                    if(!warehouse.some(p => p.id === id)) {
                        warehouse.push({
                            id: id, raw: c[1]?.replace(/"/g, ''),
                            name: c[1]?.replace(/\[.*?\]|\(.*?\)|"/g, '').split(' ').slice(0, 5).join(' ').trim(),
                            l: c[8]?.trim() || c[7]?.trim(), img: '', done: false
                        });
                    }
                }
            });
        }
        save();
    };

    function save() {
        localStorage.setItem('familyWarehouse_2026', JSON.stringify(warehouse));
        renderWarehouse();
    }

    function renderWarehouse() {
        document.getElementById('storageNote').innerText = `Kho: ${warehouse.length} m√≥n.`;
        const tbody = document.getElementById('productArea');
        tbody.innerHTML = warehouse.slice(-20).reverse().map(p => `
            <tr style="${p.done ? 'opacity:0.5' : ''}">
                <td><div class="img-slot" onclick="uploadImg('${p.id}')">${p.img ? `<img src="${p.img}">` : '+'}</div></td>
                <td><input type="text" class="edit-name" value="${p.name}" onchange="updateItem('${p.id}', 'name', this.value)"></td>
                <td>
                    <button class="btn" style="background:#636e72; font-size:9px; margin-bottom:4px" onclick="window.open('${p.l}', '_blank')">1. L·∫•y Link G·ªëc</button>
                    <input type="text" class="aff-link" value="${p.l.includes('product') ? '' : p.l}" onchange="updateItem('${p.id}', 'l', this.value)" placeholder="2. D√°n link r√∫t g·ªçn...">
                </td>
                <td>
                    <button class="btn" style="background:var(--v); margin-bottom:2px" onclick="askAI('DeepSeek', '${p.id}')">DeepSeek</button>
                    <button class="btn" style="background:var(--s)" onclick="askAI('Gemini', '${p.id}')">Gemini</button>
                </td>
                <td><input type="checkbox" ${p.done ? 'checked' : ''} onclick="updateItem('${p.id}', 'done', this.checked)"></td>
            </tr>
        `).join('');
    }

    function askAI(ai, id) {
        if(!currentP) return alert("B√© ph·∫£i ch·ªçn m·ªôt ng∆∞·ªùi th√¢n ·ªü B∆∞·ªõc 1 tr∆∞·ªõc nh√©!");
        const p = warehouse.find(x => x.id === id);
        const prompt = `Vi·∫øt truy·ªán ng·ª• ng√¥n h√†i h∆∞·ªõc v·ªÅ "${currentP.name}" (${currentP.gen}, ${currentP.age} tu·ªïi) v√† m√≥n ƒë·ªì "${p.name}". C√¢u chuy·ªán ng·∫Øn g·ªçn, l·ªìng gh√©p c√¥ng d·ª•ng s·∫£n ph·∫©m d√≠ d·ªèm. K·∫øt b√†i k√™u g·ªçi mua t·∫°i: ${p.l}`;
        navigator.clipboard.writeText(prompt);
        alert(`ƒê√£ copy l·ªánh cho ${ai}!\nS·∫£n ph·∫©m: ${p.name}\nNg∆∞·ªùi nh·∫≠n: ${currentP.name}`);
        window.open(ai === 'Gemini' ? "https://gemini.google.com/" : "https://chat.deepseek.com/", "_blank");
    }

    function uploadImg(id) {
        const inp = document.createElement('input'); inp.type = 'file'; inp.accept = 'image/*';
        inp.onchange = (e) => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = (ev) => {
                const img = new Image();
                img.onload = () => {
                    const cvs = document.createElement('canvas');
                    cvs.width = 150; cvs.height = 150;
                    cvs.getContext('2d').drawImage(img, 0, 0, 150, 150);
                    const idx = warehouse.findIndex(p => p.id === id);
                    warehouse[idx].img = cvs.toDataURL('image/jpeg', 0.6);
                    save();
                };
                img.src = ev.target.result;
            };
            reader.readAsDataURL(file);
        };
        inp.click();
    }

    function updateItem(id, key, val) {
        const idx = warehouse.findIndex(p => p.id === id);
        warehouse[idx][key] = val;
        save();
    }

    function exportJS() {
        const blob = new Blob(["const myProducts = " + JSON.stringify(warehouse)], {type: 'application/javascript'});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'products.js';
        a.click();
    }

    renderMembers();
    renderWarehouse();
</script>

</body>
</html>
