<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kho H√†ng T·ªïng & L·ªãch ƒêƒÉng B√†i - Nam Nguy·ªÖn</title>
    <style>
        :root { --primary: #ee4d2d; --dark: #2c3e50; --success: #28a745; }
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: auto; }
        
        .header { background: var(--dark); color: white; padding: 20px; border-radius: 15px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .btn-action { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-export { background: var(--success); color: white; }
        .btn-clear { background: #dc3545; color: white; }

        .dashboard { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 20px; }
        .stat-card { background: white; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-top: 5px solid var(--primary); }
        .stat-card h3 { margin: 0; font-size: 14px; color: #666; }
        .stat-card div { font-size: 24px; font-weight: bold; color: var(--dark); }

        .schedule-table { width: 100%; background: white; border-collapse: collapse; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        th { background: #eee; padding: 15px; text-align: left; font-size: 14px; }
        td { padding: 15px; border-bottom: 1px solid #f0f0f0; }
        
        .tier-tag { padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: bold; color: white; }
        .tier-L { background: #dc3545; } .tier-T { background: #007bff; }
        .tier-C { background: #6f42c1; } .tier-D { background: #ffc107; color: black; }
        
        .bio-clock { background: #e8f5e9; color: #2e7d32; padding: 5px 10px; border-radius: 20px; font-size: 12px; font-weight: bold; }
        .copy-box { cursor: pointer; color: var(--primary); font-weight: bold; }
        .copy-box:hover { text-decoration: underline; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div>
            <h1 style="margin:0;">üì¶ KHO H√ÄNG T·ªîNG</h1>
            <p style="margin:5px 0 0 0; opacity: 0.8;">H·ªá th·ªëng t·ª± ƒë·ªông l·∫≠p l·ªãch nh·ªãp sinh h·ªçc</p>
        </div>
        <div style="display: flex; gap: 10px;">
            <button class="btn-action btn-export" onclick="exportExcel()">üìÅ XU·∫§T L·ªäCH ƒêƒÇNG (CSV)</button>
            <button class="btn-action btn-clear" onclick="clearAll()">üóëÔ∏è X√ìA KHO</button>
        </div>
    </div>

    <div class="dashboard" id="statDashboard">
        </div>

    <table class="schedule-table">
        <thead>
            <tr>
                <th>T·∫ßng</th>
                <th>S·∫£n ph·∫©m</th>
                <th>Gi√°</th>
                <th>Gi·ªù ƒêƒÉng B√†i (G·ª£i √Ω)</th>
                <th>Link Affiliate</th>
                <th>Thao t√°c</th>
            </tr>
        </thead>
        <tbody id="scheduleBody"></tbody>
    </table>
</div>

<script>
    let warehouse = JSON.parse(localStorage.getItem('shopee_warehouse')) || [];

    // C√¥ng th·ª©c nh·ªãp sinh h·ªçc
    function getBioTime(tier, index) {
        const times = {
            'L': ['08:30', '11:45', '12:30', '20:00', '21:30'], // ƒê·ªì r·∫ª: ƒêƒÉng gi·ªù ngh·ªâ, gi·∫£i tr√≠
            'T': ['09:00', '15:00', '19:30', '20:30'],         // ƒê·ªì v·ª´a: ƒêƒÉng gi·ªù h√†nh ch√≠nh r·∫£nh
            'C': ['10:30', '14:30', '20:00'],                 // ƒê·ªì cao: ƒêƒÉng gi·ªù t√¢m l√Ω tho·∫£i m√°i
            'D': ['07:30', '21:00']                           // ƒê·ªì ƒë·∫Øt: ƒêƒÉng s√°ng s·ªõm ho·∫∑c t·ªëi mu·ªôn
        };
        let slot = times[tier] || ['09:00'];
        return slot[index % slot.length];
    }

    function renderAll() {
        const body = document.getElementById('scheduleBody');
        const dash = document.getElementById('statDashboard');
        body.innerHTML = '';
        
        let stats = { L:0, T:0, C:0, D:0, total: warehouse.length };

        warehouse.forEach((item, i) => {
            stats[item.tier]++;
            let time = getBioTime(item.tier, i);
            
            body.innerHTML += `
                <tr>
                    <td><span class="tier-tag tier-${item.tier}">T·∫¶NG ${item.tier}</span></td>
                    <td style="font-weight:500;">${item.name.substring(0,40)}...</td>
                    <td style="color:#ee4d2d; font-weight:bold;">${Number(item.price).toLocaleString()}ƒë</td>
                    <td><span class="bio-clock">‚è∞ ${time}</span></td>
                    <td class="copy-box" onclick="copyLink('${item.link}')">Copy Link</td>
                    <td><button onclick="removeItem(${i})" style="border:none; background:none; cursor:pointer;">‚ùå</button></td>
                </tr>
            `;
        });

        dash.innerHTML = `
            <div class="stat-card"><h3>T·ªîNG M√É</h3><div>${stats.total}</div></div>
            <div class="stat-card"><h3>T·∫¶NG L (R·∫∫)</h3><div>${stats.L}</div></div>
            <div class="stat-card"><h3>T·∫¶NG T (V·ª™A)</h3><div>${stats.T}</div></div>
            <div class="stat-card"><h3>T·∫¶NG C-D (CAO)</h3><div>${stats.C + stats.D}</div></div>
        `;
    }

    function copyLink(link) {
        navigator.clipboard.writeText(link);
        alert("ƒê√£ copy link th√†nh c√¥ng!");
    }

    function removeItem(index) {
        if(confirm("X√≥a m√≥n n√†y kh·ªèi kho?")) {
            warehouse.splice(index, 1);
            localStorage.setItem('shopee_warehouse', JSON.stringify(warehouse));
            renderAll();
        }
    }

    function clearAll() {
        if(confirm("B·∫°n mu·ªën x√≥a s·∫°ch kho h√†ng ƒë·ªÉ l√†m t·ªáp m·ªõi?")) {
            localStorage.removeItem('shopee_warehouse');
            warehouse = [];
            renderAll();
        }
    }

    function exportExcel() {
        if(warehouse.length === 0) return alert("Kho ƒëang tr·ªëng!");
        let csv = "Gi·ªù ƒêƒÉng,S·∫£n Ph·∫©m,Gi√°,Link Affiliate\n";
        warehouse.forEach((item, i) => {
            csv += `${getBioTime(item.tier, i)},"${item.name}",${item.price},${item.link}\n`;
        });
        const blob = new Blob(["\uFEFF" + csv], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `Lich_Dang_Bai_Nam_Nguyen_${new Date().toLocaleDateString()}.csv`;
        a.click();
    }

    window.onload = renderAll;
</script>
</body>
</html>